(this.webpackJsonplayers=this.webpackJsonplayers||[]).push([[0],{188:function(e,t,i){},189:function(e,t,i){},226:function(e,t){},230:function(e,t,i){"use strict";i.r(t);var n=i(0),a=i.n(n),s=i(85),c=i.n(s),o=(i(188),i(189),i(90)),l=i(165),r=(i(221),i(162)),d=i.n(r),p=i(269),j=i(257),b=i(258);var u=i(8);const m=[{title:"Streets",url:"mapbox://styles/mapbox/streets-v11",icon:"streets-v11"},{title:"Satellite",url:"mapbox://styles/mapbox/satellite-v9",icon:"satellite-v9"}];var h=function(e){let{setBasemap:t,viewport:i,mapboxApiAccessToken:a}=e;const s=function(e,t){const[i,a]=Object(n.useState)(e);return Object(n.useEffect)((()=>{const i=setTimeout((()=>{a(e)}),t);return()=>{clearTimeout(i)}}),[e,t]),i}(i,1e3),c=m.map((e=>Object(n.useRef)(null))),[o,l]=Object(n.useState)(!1);return Object(n.useEffect)((()=>{setTimeout((()=>l(!0)),3e3)}),[]),Object(n.useEffect)((()=>{if(!o)return;Promise.all(m.map(((e,t)=>(async e=>{const t=new Image,i=m[e];t.onload=()=>{const i=c[e].current,n=i.getContext("2d");let a=0;const s=()=>{a+=.01,n.globalAlpha=a;let e=i.width,c=i.height,o=0,l=0;t.height>t.width?(c=e/t.width*t.height,l=(i.height-c)/2):(e=c/t.height*t.width,o=(i.width-e)/2),n.drawImage(t,o,l,e,c),a<1&&requestAnimationFrame(s)};requestAnimationFrame(s)},t.src=`https://api.mapbox.com/styles/v1/mapbox/${i.icon}/static/${s.longitude},${s.latitude},${s.zoom}/${Math.min(s.width,1280)}x${Math.min(s.height,1280)}?access_token=${a}`})(t))))}),[o,s,c,a]),Object(u.jsx)(p.a,{p:1,children:Object(u.jsx)(j.a,{children:Object(u.jsx)(p.a,{pt:.5,pb:.5,display:"flex",flexDirection:"column",children:m.map(((e,i)=>Object(u.jsx)(b.a,{onClick:()=>{t(e.url)},children:Object(u.jsx)("canvas",{style:{border:"1px solid rgba(0, 0, 0, 0.5)",borderRadius:5},ref:c[i],width:50,height:50})},i)))})})})},x=i(263),O=i(154),g=i.n(O);var f=function(e){let{viewport:t,basemap:i,mapboxApiAccessToken:a,setBasemap:s,setAddingLocations:c,addingLocations:o}=e;const[l,r]=Object(n.useState)(!1);return Object(n.useEffect)((()=>{setTimeout((()=>r(!0)),3e3)}),[]),Object(u.jsxs)(x.a.div,{initial:{opacity:0},animate:{opacity:l>0?1:0},children:[Object(u.jsx)(p.a,{p:1,pb:0,children:Object(u.jsx)(j.a,{children:Object(u.jsx)(p.a,{p:.5,display:"flex",flexDirection:"column",children:Object(u.jsx)(b.a,{onClick:()=>{c((e=>!e))},children:Object(u.jsx)(g.a,{color:o?"success":"disabled"})})})})}),Object(u.jsx)(h,{viewport:t,basemap:i,mapboxApiAccessToken:a,setBasemap:s})]})},w=i(261),v=i(262),y=i(161),S=i.n(y),A=i(160),T=i.n(A),k=i(268),C=i(264);function F(e){let{data:t,viewState:i}=e;const a=57600,[s,c]=Object(n.useState)(0),[o]=Object(n.useState)({}),l=Object(n.useCallback)((()=>{c((e=>(e+a)%864e5)),o.id=window.requestAnimationFrame(l)}),[o,a]);Object(n.useEffect)((()=>(o.id=window.requestAnimationFrame(l),()=>window.cancelAnimationFrame(o.id))),[o,l]),Object(n.useEffect)((()=>{t.length}),[t]);const r=new k.a({id:"trips-layer",data:t,getPath:e=>e.waypoints.map((e=>e.coordinates)),getTimestamps:e=>e.waypoints.map((e=>e.timestamp)),getColor:[253,128,93],opacity:.8,widthMinPixels:5,rounded:!0,fadeTrail:!0,trailLength:864e4,currentTime:s,shadowEnabled:!1});return Object(u.jsx)(C.a,{viewState:i,layers:[r]})}var E=i(158),z=i.n(E),I=i(159),L=i.n(I);const $="pk.eyJ1IjoicGFsaWtrIiwiYSI6ImNrdnV0cG1mejBxbTYyb2p0OWI4c3FwYzUifQ.rOxZMX2Ozv495OthpRCTpg";var B=function(){const[e,t]=Object(n.useState)({width:window.innerWidth,height:window.innerHeight,latitude:65.41,longitude:25.88,zoom:4.3}),[i,a]=Object(n.useState)(m[1].url),s=Object(n.useRef)();window.onresize=()=>{t({...e,width:window.innerWidth,height:window.innerHeight})};const c=Object(n.useCallback)((e=>{t(e)}),[]),[r,j]=Object(n.useState)([]),[b,h]=Object(n.useState)(!1);Object(n.useEffect)((()=>{console.log(r)}),[r]),Object(n.useEffect)((()=>{g([{waypoints:[{coordinates:[24,61],timestamp:1636840097955},{coordinates:[25,62],timestamp:1636840097955},{coordinates:[25,63],timestamp:1636840097975}]}]),(async()=>{const e=await fetch("ships"),t=(await e.text()).split("\n").filter((e=>e)).map((e=>{const t=JSON.parse(e);return{waypoints:L.a.zip(z.a.decode(t[0]),t[1]).map((e=>({coordinates:e[0],timestamp:e[1]})))}}));g(t)})()}),[]);const[O,g]=Object(n.useState)([]);return Object(n.useEffect)((()=>{console.log("??",O),console.log("??",JSON.stringify(O))}),[O]),Object(u.jsxs)("div",{children:[Object(u.jsx)("div",{style:{position:"absolute",zIndex:2,bottom:30},children:Object(u.jsx)(f,{viewport:e,basemap:i,mapboxApiAccessToken:$,setBasemap:a,setAddingLocations:h,addingLocations:b})}),Object(u.jsx)("div",{style:{position:"absolute",top:0,left:0},children:Object(u.jsxs)(o.d,{...e,ref:s,mapStyle:i,onNativeClick:e=>{if(b){const t=e.lngLat;j(r.concat({id:(new Date).getTime(),latitude:t[1],longitude:t[0],popup:!1}))}},mapboxApiAccessToken:$,onViewportChange:e=>t(e),children:[O.length&&Object(u.jsx)(F,{data:O,viewState:e}),r.map((e=>{const t=`lat: ${e.latitude.toFixed(5)}, lng: ${e.longitude.toFixed(5)}`;return Object(u.jsxs)(u.Fragment,{children:[e.popup&&Object(u.jsx)(o.c,{latitude:e.latitude,longitude:e.longitude,style:{zIndex:100},closeButton:!1,children:Object(u.jsxs)(p.a,{display:"flex",flexDirection:"column",children:[Object(u.jsx)(p.a,{position:"absolute",top:"5px",right:"5px",children:Object(u.jsx)(w.a,{size:"small",onClick:()=>{j(r.map((t=>t.id===e.id?{...t,popup:!1}:t)))},children:Object(u.jsx)(T.a,{})})}),Object(u.jsx)(p.a,{children:Object(u.jsx)("br",{})}),Object(u.jsxs)(v.a,{children:[t,Object(u.jsx)(w.a,{size:"small",onClick:()=>navigator.clipboard.writeText(t),children:Object(u.jsx)(S.a,{fontSize:"16px"})})]})]})},e.id),Object(u.jsx)(x.a.div,{initial:{opacity:0},animate:{opacity:[0,.3,.5,1],translateY:[-100,0]},transition:{duration:.3,ease:"easeOut"},children:Object(u.jsx)(o.b,{offsetLeft:-12,offsetTop:-24,draggable:!0,latitude:e.latitude,longitude:e.longitude,onDragEnd:t=>{((e,t)=>{j(r.map((i=>i.id===e?{...i,latitude:t.lngLat[1],longitude:t.lngLat[0]}:i)))})(e.id,t)},onClick:t=>{var i;i=e.id,j(r.map((e=>e.id===i?{...e,popup:!0}:e)))},children:Object(u.jsx)(d.a,{color:"info"})},e.id)})]})})),Object(u.jsx)(l.a,{mapRef:s,onViewportChange:c,mapboxApiAccessToken:$,position:"top-right"})]})})]})};var D=function(){return Object(u.jsx)(B,{})};var J=e=>{e&&e instanceof Function&&i.e(3).then(i.bind(null,273)).then((t=>{let{getCLS:i,getFID:n,getFCP:a,getLCP:s,getTTFB:c}=t;i(e),n(e),a(e),s(e),c(e)}))};c.a.render(Object(u.jsx)(a.a.StrictMode,{children:Object(u.jsx)(D,{})}),document.getElementById("root")),J()},99:function(e,t){}},[[230,1,2]]]);
//# sourceMappingURL=main.2b1ee801.chunk.js.map