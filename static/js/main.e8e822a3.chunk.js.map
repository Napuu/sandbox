{"version":3,"sources":["BasemapSelector.js","hooks.js","Controls.js","Map.js","App.js","reportWebVitals.js","index.js"],"names":["basemaps","title","url","icon","setBasemap","viewport","mapboxApiAccessToken","debouncedViewport","value","delay","debouncedValue","setDebouncedValue","useState","useEffect","handler","setTimeout","clearTimeout","useDebounce","basemapCanvasRefs","map","basemap","useRef","justLoaded","setJustLoaded","Promise","all","_","i","async","img","Image","index","onload","canvas","current","ctx","getContext","test","globalAlpha","drawableWidth","width","drawableHeight","height","x","y","drawImage","requestAnimationFrame","src","longitude","latitude","zoom","Math","min","setImage","Box","p","Paper","pt","pb","display","flexDirection","Button","onClick","style","borderRadius","ref","Controls","setAddingLocations","addingLocations","motion","div","initial","opacity","animate","color","BasemapSelector","Map","setViewport","window","innerWidth","innerHeight","setBaseMap","onresize","handleGeocoderViewportChange","useCallback","newViewport","console","log","v","markers","setMarkers","position","zIndex","bottom","process","top","left","mapStyle","onNativeClick","ev","coordinates","lngLat","concat","id","Date","getTime","popup","onViewportChange","nextViewport","marker","text","toFixed","closeButton","right","IconButton","size","m","Typography","navigator","clipboard","writeText","fontSize","translateY","transition","duration","ease","offsetLeft","offsetTop","draggable","onDragEnd","handleMarkerDragEnd","mapRef","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.e8e822a3.chunk.js","sourcesContent":["import { Button, Paper, Box } from '@material-ui/core';\nimport { useEffect, useRef, useState } from 'react';\nimport { useDebounce } from \"./hooks\";\n\nexport const basemaps = [\n  { title: \"Streets\", url: \"mapbox://styles/mapbox/streets-v11\", icon: \"streets-v11\" },\n  { title: \"Satellite\", url: \"mapbox://styles/mapbox/satellite-v9\", icon: \"satellite-v9\" },\n];\n\n// No idea what is going on here.\n// Trying to use named function breaks useRef.\n// eslint-disable-next-line\nexport default function ({ setBasemap, viewport, mapboxApiAccessToken }) {\n\n  const debouncedViewport = useDebounce(viewport, 1000);\n  const basemapCanvasRefs = basemaps.map(basemap => useRef(null));\n\n  const [justLoaded, setJustLoaded] = useState(false);\n  useEffect(() => {\n    setTimeout(() => setJustLoaded(true), 3000);\n  }, []);\n  useEffect(() => {\n    if (!justLoaded) return;\n\n    const setImage = async (index) => {\n      const img = new Image();\n      const basemap = basemaps[index];\n      img.onload = () => {\n        const canvas = basemapCanvasRefs[index].current;\n        const ctx = canvas.getContext(\"2d\");\n        let i = 0;\n        const test = () => {\n          i += 0.01;\n          ctx.globalAlpha = i;\n          let drawableWidth = canvas.width;\n          let drawableHeight = canvas.height;\n          let x = 0, y = 0;\n          if (img.height > img.width) {\n            drawableHeight = drawableWidth / img.width * img.height;\n            y = (canvas.height - drawableHeight) / 2;\n          } else {\n            drawableWidth = drawableHeight / img.height * img.width;\n            x = (canvas.width - drawableWidth) / 2;\n          }\n          ctx.drawImage(img, x, y, drawableWidth, drawableHeight);\n          if (i < 1) {\n            requestAnimationFrame(test);\n          }\n        };\n        requestAnimationFrame(test);\n      };\n      img.src = `https://api.mapbox.com/styles/v1/mapbox/${basemap.icon}/static/${debouncedViewport.longitude},${debouncedViewport.latitude},${debouncedViewport.zoom}/${Math.min(debouncedViewport.width, 1280)}x${Math.min(debouncedViewport.height, 1280)}?access_token=${mapboxApiAccessToken}`;\n    };\n    Promise.all(basemaps.map((_, i) => {\n      return setImage(i);\n    }));\n  }, [justLoaded, debouncedViewport, basemapCanvasRefs, mapboxApiAccessToken]);\n\n  return (\n    <Box p={1}>\n      <Paper>\n        <Box pt={0.5} pb={0.5} display=\"flex\" flexDirection=\"column\">\n          {basemaps.map((basemap, i) => (\n            <Button key={i} onClick={() => {\n              setBasemap(basemap.url);\n            }}>\n              <canvas style={{\"border\": \"1px solid rgba(0, 0, 0, 0.5)\", borderRadius: 5}} ref={basemapCanvasRefs[i]} width={50} height={50} />\n            </Button>\n          ))}\n        </Box>\n      </Paper>\n    </Box>\n  );\n}\n","// Hook\nimport { useRef, useState, useEffect } from 'react';\nexport function useDebounce(value, delay) {\n  // State and setters for debounced value\n  const [debouncedValue, setDebouncedValue] = useState(value);\n\n  useEffect(\n    () => {\n      // Update debounced value after delay\n      const handler = setTimeout(() => {\n        setDebouncedValue(value);\n      }, delay);\n\n      // Cancel the timeout if value changes (also on delay change or unmount)\n      // This is how we prevent debounced value from updating if value is changed ...\n      // .. within the delay period. Timeout gets cleared and restarted.\n      return () => {\n        clearTimeout(handler);\n      };\n    },\n    [value, delay] // Only re-call effect if value or delay changes\n  );\n\n  return debouncedValue;\n}\n\nexport function usePrevious(value) {\n  // The ref object is a generic container whose current property is mutable ...\n  // ... and can hold any value, similar to an instance property on a class\n  const ref = useRef();\n\n  // Store current value in ref\n  useEffect(() => {\n    ref.current = value;\n  }, [value]); // Only re-run if value changes\n\n  // Return previous value (happens before update in useEffect above)\n  return ref.current;\n}","import React, {useState, useEffect} from 'react';\nimport { Button, Paper, Box } from '@material-ui/core';\nimport AddLocationAltIcon from '@mui/icons-material/AddLocationAlt';\nimport BasemapSelector from './BasemapSelector';\nimport { motion } from 'framer-motion';\n\nfunction Controls({viewport, basemap, mapboxApiAccessToken, setBasemap, setAddingLocations, addingLocations}) {\n  const [justLoaded, setJustLoaded] = useState(false);\n  useEffect(() => {\n    setTimeout(() => setJustLoaded(true), 3000);\n  }, []);\n  return (<motion.div initial={{ opacity: 0 }} animate={{ opacity: justLoaded > 0 ? 1 : 0 }}>\n      <Box p={1} pb={0}>\n        <Paper>\n          <Box p={0.5} display=\"flex\" flexDirection=\"column\">\n            <Button onClick={() => { setAddingLocations(p => !p); }}>\n              <AddLocationAltIcon color={addingLocations ? \"success\" : \"disabled\"} />\n            </Button>\n          </Box >\n        </Paper>\n      </Box>\n      <BasemapSelector\n        viewport={viewport}\n        basemap={basemap}\n        mapboxApiAccessToken={mapboxApiAccessToken}\n        setBasemap={setBasemap} />\n  </motion.div >\n  );\n}\n\nexport default Controls;","import { useCallback, useEffect, useRef, useState } from 'react';\nimport { InteractiveMap, Marker, Popup } from 'react-map-gl';\nimport Geocoder from \"react-map-gl-geocoder\";\nimport 'react-map-gl-geocoder/dist/mapbox-gl-geocoder.css';\nimport RoomIcon from '@mui/icons-material/Room';\nimport { basemaps } from \"./BasemapSelector\";\nimport { motion } from 'framer-motion';\nimport Controls from './Controls';\nimport { Box, IconButton, Typography } from '@material-ui/core';\nimport ContentCopyIcon from '@mui/icons-material/ContentCopy';\nimport CloseIcon from '@mui/icons-material/Close';\n\nfunction Map() {\n  const [viewport, setViewport] = useState({\n    width: window.innerWidth,\n    height: window.innerHeight,\n    latitude: 65.41,\n    longitude: 25.88,\n    zoom: 4.3\n  });\n\n  const [basemap, setBaseMap] = useState(basemaps[0].url);\n  const map = useRef();\n  window.onresize = () => {\n    setViewport({\n      ...viewport,\n      width: window.innerWidth,\n      height: window.innerHeight\n    });\n  };\n\n  const handleGeocoderViewportChange = useCallback(\n    (newViewport) => {\n      console.log(newViewport);\n      setViewport(v => { return { ...v, ...newViewport }; });\n    },\n    [setViewport]\n  );\n\n  const [markers, setMarkers] = useState([]);\n  const [addingLocations, setAddingLocations] = useState(false);\n\n  const handleOnClick = (ev) => {\n    if (addingLocations) {\n      const coordinates = ev.lngLat;\n      setMarkers(markers.concat({ id: new Date().getTime(), latitude: coordinates[1], longitude: coordinates[0], popup: false }));\n    }\n  };\n\n  const handleMarkerDragEnd = (id, ev) => {\n    setMarkers(markers.map(m => (m.id === id ? { ...m, latitude: ev.lngLat[1], longitude: ev.lngLat[0] } : m)));\n  };\n\n  useEffect(() => {\n    console.log(markers);\n  }, [markers]);\n  const handleMarkerClick = (id, ev) => {\n    setMarkers(markers.map(m => (m.id === id ? { ...m, popup: true } : m)));\n  };\n\n  return (<div>\n    <div style={{ position: \"absolute\", zIndex: 2, bottom: 30 }}>\n      <Controls\n        viewport={viewport}\n        basemap={basemap}\n        mapboxApiAccessToken={process.env.REACT_APP_MAPBOX_TOKEN}\n        setBasemap={setBaseMap}\n        setAddingLocations={setAddingLocations}\n        addingLocations={addingLocations}\n      />\n    </div>\n    <div style={{ position: 'absolute', top: 0, left: 0 }}>\n      <InteractiveMap\n        {...viewport}\n        ref={map}\n        mapStyle={basemap}\n        onNativeClick={handleOnClick}\n        mapboxApiAccessToken={process.env.REACT_APP_MAPBOX_TOKEN}\n        onViewportChange={nextViewport => setViewport(nextViewport)}\n      >\n        {markers.map(marker => {\n          const text = `lat: ${marker.latitude.toFixed(5)}, lng: ${marker.longitude.toFixed(5)}`;\n          return (<>\n            {marker.popup &&\n              <Popup\n                key={marker.id}\n                latitude={marker.latitude}\n                longitude={marker.longitude}\n                style={{ zIndex: 100 }}\n                closeButton={false}\n              >\n                <Box display=\"flex\" flexDirection=\"column\">\n                  <Box position=\"absolute\" top=\"5px\" right=\"5px\">\n                    <IconButton size=\"small\" onClick={() => { setMarkers(markers.map(m => (m.id === marker.id ? { ...m, popup: false } : m))); }} >\n                      <CloseIcon />\n                    </IconButton>\n                  </Box>\n                  <Box><br /></Box>\n                  <Typography>\n                    {text}\n                    <IconButton size=\"small\" onClick={() => navigator.clipboard.writeText(text)}><ContentCopyIcon fontSize=\"16px\" /></IconButton>\n                  </Typography>\n                </Box>\n              </Popup>\n            }\n            <motion.div\n              initial={{ opacity: 0 }}\n              animate={{ opacity: [0, 0.3, 0.5, 1], translateY: [-100, 0] }}\n              transition={{ duration: 0.3, ease: 'easeOut' }}\n            >\n              <Marker\n                offsetLeft={-12}\n                offsetTop={-24}\n                draggable={true}\n                key={marker.id}\n                latitude={marker.latitude}\n                longitude={marker.longitude}\n                onDragEnd={(ev) => { handleMarkerDragEnd(marker.id, ev); }}\n                onClick={(ev) => { handleMarkerClick(marker.id, ev); }}\n              >\n                <RoomIcon color={\"info\"} />\n              </Marker>\n            </motion.div>\n          </>\n          );\n        })}\n        {map.current &&\n          <Geocoder\n            mapRef={map}\n            style={{ fontSize: '12px' }}\n            onViewportChange={handleGeocoderViewportChange}\n            mapboxApiAccessToken={process.env.REACT_APP_MAPBOX_TOKEN}\n            position=\"top-right\"\n          />}\n      </InteractiveMap>\n    </div>\n  </div>\n  );\n}\nexport default Map;","import './App.css';\nimport Map from './Map';\n\nfunction App() {\n  return (\n    <Map />\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}