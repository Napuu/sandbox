{"version":3,"sources":["BasemapSelector.js","hooks.js","Controls.js","Map.js","App.js","reportWebVitals.js","index.js"],"names":["basemaps","title","url","icon","setBasemap","viewport","mapboxApiAccessToken","debouncedViewport","value","delay","useState","debouncedValue","setDebouncedValue","useEffect","handler","setTimeout","clearTimeout","useDebounce","basemapCanvasRefs","map","basemap","useRef","justLoaded","setJustLoaded","setImage","index","a","img","Image","onload","canvas","current","ctx","getContext","i","requestAnimationFrame","test","globalAlpha","drawableWidth","width","drawableHeight","height","drawImage","src","longitude","latitude","zoom","Math","min","Promise","all","_","Box","p","Paper","display","flexDirection","Button","onClick","ref","Controls","setAddingLocations","addingLocations","motion","div","initial","opacity","animate","BasemapSelector","pt","color","Map","setViewport","window","innerWidth","innerHeight","setBaseMap","onresize","handleGeocoderViewportChange","useCallback","newViewport","console","log","v","markers","setMarkers","style","position","zIndex","process","top","left","mapStyle","onNativeClick","ev","coordinates","lngLat","concat","id","Date","getTime","popup","onViewportChange","nextViewport","marker","text","toFixed","closeButton","right","IconButton","size","m","Typography","navigator","clipboard","writeText","fontSize","translateY","transition","duration","ease","offsetLeft","offsetTop","draggable","onDragEnd","handleMarkerDragEnd","mapRef","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.99fbff8d.chunk.js","sourcesContent":["import { Button, Paper, Box } from '@material-ui/core';\nimport { useEffect, useRef, useState } from 'react';\nimport { useDebounce } from \"./hooks\";\n\nexport const basemaps = [\n  { title: \"Streets\", url: \"mapbox://styles/mapbox/streets-v11\", icon: \"streets-v11\" },\n  { title: \"Satellite\", url: \"mapbox://styles/mapbox/satellite-v9\", icon: \"satellite-v9\" },\n];\n\n// No idea what is going on here.\n// Trying to use named function breaks useRef.\n// eslint-disable-next-line\nexport default function ({ setBasemap, viewport, mapboxApiAccessToken }) {\n\n  const debouncedViewport = useDebounce(viewport, 1000);\n  const basemapCanvasRefs = basemaps.map(basemap => useRef(null));\n\n  const [justLoaded, setJustLoaded] = useState(false);\n  useEffect(() => {\n    setTimeout(() => setJustLoaded(true), 3000);\n  }, []);\n  useEffect(() => {\n    if (!justLoaded) return;\n\n    const setImage = async (index) => {\n      const img = new Image();\n      const basemap = basemaps[index];\n      img.onload = () => {\n        const canvas = basemapCanvasRefs[index].current;\n        const ctx = canvas.getContext(\"2d\");\n        let i = 0;\n        const test = () => {\n          i += 0.01;\n          ctx.globalAlpha = i;\n          let drawableWidth = canvas.width;\n          let drawableHeight = canvas.height;\n          if (drawableHeight > drawableWidth) {\n            drawableHeight = drawableWidth / img.width * img.height;\n          } else {\n            drawableWidth = drawableHeight / img.height * img.width;\n          }\n          ctx.drawImage(img, 0, 0, drawableWidth, drawableHeight);\n          if (i < 1) {\n            requestAnimationFrame(test);\n          }\n        };\n        requestAnimationFrame(test);\n      };\n      img.src = `https://api.mapbox.com/styles/v1/mapbox/${basemap.icon}/static/${debouncedViewport.longitude},${debouncedViewport.latitude},${debouncedViewport.zoom}/${Math.min(debouncedViewport.width, 1280)}x${Math.min(debouncedViewport.height, 1280)}?access_token=${mapboxApiAccessToken}`;\n    };\n    Promise.all(basemaps.map((_, i) => {\n      return setImage(i);\n    }));\n  }, [justLoaded, debouncedViewport, basemapCanvasRefs, mapboxApiAccessToken]);\n\n  return (\n    <Box p={1}>\n      <Paper>\n        <Box p={0.5} display=\"flex\" flexDirection=\"column\">\n          {basemaps.map((basemap, i) => (\n            <Button key={i} onClick={() => {\n              setBasemap(basemap.url);\n            }}>\n              <canvas ref={basemapCanvasRefs[i]} width={75} height={75} />\n            </Button>\n          ))}\n        </Box>\n      </Paper>\n    </Box>\n  );\n}\n","// Hook\nimport { useRef, useState, useEffect } from 'react';\nexport function useDebounce(value, delay) {\n  // State and setters for debounced value\n  const [debouncedValue, setDebouncedValue] = useState(value);\n\n  useEffect(\n    () => {\n      // Update debounced value after delay\n      const handler = setTimeout(() => {\n        setDebouncedValue(value);\n      }, delay);\n\n      // Cancel the timeout if value changes (also on delay change or unmount)\n      // This is how we prevent debounced value from updating if value is changed ...\n      // .. within the delay period. Timeout gets cleared and restarted.\n      return () => {\n        clearTimeout(handler);\n      };\n    },\n    [value, delay] // Only re-call effect if value or delay changes\n  );\n\n  return debouncedValue;\n}\n\nexport function usePrevious(value) {\n  // The ref object is a generic container whose current property is mutable ...\n  // ... and can hold any value, similar to an instance property on a class\n  const ref = useRef();\n\n  // Store current value in ref\n  useEffect(() => {\n    ref.current = value;\n  }, [value]); // Only re-run if value changes\n\n  // Return previous value (happens before update in useEffect above)\n  return ref.current;\n}","import React, {useState, useEffect} from 'react';\nimport { Button, Paper, Box } from '@material-ui/core';\nimport AddLocationAltIcon from '@mui/icons-material/AddLocationAlt';\nimport BasemapSelector from './BasemapSelector';\nimport { motion } from 'framer-motion';\n\nfunction Controls({viewport, basemap, mapboxApiAccessToken, setBasemap, setAddingLocations, addingLocations}) {\n  const [justLoaded, setJustLoaded] = useState(false);\n  useEffect(() => {\n    setTimeout(() => setJustLoaded(true), 3000);\n  }, []);\n  return (<motion.div initial={{ opacity: 0 }} animate={{ opacity: justLoaded > 0 ? 1 : 0 }}>\n      <BasemapSelector\n        viewport={viewport}\n        basemap={basemap}\n        mapboxApiAccessToken={mapboxApiAccessToken}\n        setBasemap={setBasemap} />\n      <Box p={1} pt={0}>\n        <Paper>\n          <Box p={0.5} display=\"flex\" flexDirection=\"column\">\n            <Button onClick={() => { setAddingLocations(p => !p); }}>\n              <AddLocationAltIcon color={addingLocations ? \"success\" : \"disabled\"} />\n            </Button>\n          </Box >\n        </Paper>\n      </Box>\n  </motion.div >\n  );\n}\n\nexport default Controls;","import { useCallback, useEffect, useRef, useState } from 'react';\nimport { InteractiveMap, Marker, Popup } from 'react-map-gl';\nimport Geocoder from \"react-map-gl-geocoder\";\nimport 'react-map-gl-geocoder/dist/mapbox-gl-geocoder.css';\nimport RoomIcon from '@mui/icons-material/Room';\nimport { basemaps } from \"./BasemapSelector\";\nimport { motion } from 'framer-motion';\nimport Controls from './Controls';\nimport { Box, IconButton, Typography } from '@material-ui/core';\nimport ContentCopyIcon from '@mui/icons-material/ContentCopy';\nimport CloseIcon from '@mui/icons-material/Close';\n\nfunction Map() {\n  const [viewport, setViewport] = useState({\n    width: window.innerWidth,\n    height: window.innerHeight,\n    latitude: 65.41,\n    longitude: 25.88,\n    zoom: 4.3\n  });\n\n  const [basemap, setBaseMap] = useState(basemaps[0].url);\n  const map = useRef();\n  window.onresize = () => {\n    setViewport({\n      ...viewport,\n      width: window.innerWidth,\n      height: window.innerHeight\n    });\n  };\n\n  const handleGeocoderViewportChange = useCallback(\n    (newViewport) => {\n      console.log(newViewport);\n      setViewport(v => { return { ...v, ...newViewport }; });\n    },\n    [setViewport]\n  );\n\n  const [markers, setMarkers] = useState([]);\n  const [addingLocations, setAddingLocations] = useState(false);\n\n  const handleOnClick = (ev) => {\n    if (addingLocations) {\n      const coordinates = ev.lngLat;\n      setMarkers(markers.concat({ id: new Date().getTime(), latitude: coordinates[1], longitude: coordinates[0], popup: false }));\n    }\n  };\n\n  const handleMarkerDragEnd = (id, ev) => {\n    setMarkers(markers.map(m => (m.id === id ? { ...m, latitude: ev.lngLat[1], longitude: ev.lngLat[0] } : m)));\n  };\n\n  useEffect(() => {\n    console.log(markers);\n  }, [markers]);\n  const handleMarkerClick = (id, ev) => {\n    setMarkers(markers.map(m => (m.id === id ? { ...m, popup: true } : m)));\n  };\n\n  return (<div>\n    <div style={{ position: \"absolute\", zIndex: 2 }}>\n      <Controls\n        viewport={viewport}\n        basemap={basemap}\n        mapboxApiAccessToken={process.env.REACT_APP_MAPBOX_TOKEN}\n        setBasemap={setBaseMap}\n        setAddingLocations={setAddingLocations}\n        addingLocations={addingLocations}\n      />\n    </div>\n    <div style={{ position: 'absolute', top: 0, left: 0 }}>\n      <InteractiveMap\n        {...viewport}\n        ref={map}\n        mapStyle={basemap}\n        onNativeClick={handleOnClick}\n        mapboxApiAccessToken={process.env.REACT_APP_MAPBOX_TOKEN}\n        onViewportChange={nextViewport => setViewport(nextViewport)}\n      >\n        {markers.map(marker => {\n          const text = `lat: ${marker.latitude.toFixed(5)}, lng: ${marker.longitude.toFixed(5)}`;\n          return (<>\n            {marker.popup &&\n              <Popup\n                key={marker.id}\n                latitude={marker.latitude}\n                longitude={marker.longitude}\n                style={{ zIndex: 100 }}\n                closeButton={false}\n              >\n                <Box display=\"flex\" flexDirection=\"column\">\n                  <Box position=\"absolute\" top=\"5px\" right=\"5px\">\n                    <IconButton size=\"small\" onClick={() => { setMarkers(markers.map(m => (m.id === marker.id ? { ...m, popup: false } : m))); }} >\n                      <CloseIcon />\n                    </IconButton>\n                  </Box>\n                  <Box><br /></Box>\n                  <Typography>\n                    {text}\n                    <IconButton size=\"small\" onClick={() => navigator.clipboard.writeText(text)}><ContentCopyIcon fontSize=\"16px\" /></IconButton>\n                  </Typography>\n                </Box>\n              </Popup>\n            }\n            <motion.div\n              initial={{ opacity: 0 }}\n              animate={{ opacity: [0, 0.3, 0.5, 1], translateY: [-100, 0] }}\n              transition={{ duration: 0.3, ease: 'easeOut' }}\n            >\n              <Marker\n                offsetLeft={-12}\n                offsetTop={-24}\n                draggable={true}\n                key={marker.id}\n                latitude={marker.latitude}\n                longitude={marker.longitude}\n                onDragEnd={(ev) => { handleMarkerDragEnd(marker.id, ev); }}\n                onClick={(ev) => { handleMarkerClick(marker.id, ev); }}\n              >\n                <RoomIcon color={\"info\"} />\n              </Marker>\n            </motion.div>\n          </>\n          );\n        })}\n        {map.current &&\n          <Geocoder\n            mapRef={map}\n            onViewportChange={handleGeocoderViewportChange}\n            mapboxApiAccessToken={process.env.REACT_APP_MAPBOX_TOKEN}\n            position=\"top-right\"\n          />}\n      </InteractiveMap>\n    </div>\n  </div>\n  );\n}\nexport default Map;","import './App.css';\nimport Map from './Map';\n\nfunction App() {\n  return (\n    <Map />\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}